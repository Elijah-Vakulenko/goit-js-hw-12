{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImages(query, page = 1) {\n    const params = new URLSearchParams({\n        key: '44023178-1b17cf85b995cf2d6fd44a474', // ← Персональний ключ\n        q: query, //← Введений нами запит\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: 15,\n    });\n    \n    try {\n        const imageRequest = await axios.get(`https://pixabay.com/api/?${params}`)\n        return imageRequest.data; //← виводимо отриману інформацію з серверу\n    } catch(error) {\n               console.error(\"Error fetching images:\", error);\n        return { hits: [] };\n    };\n};\n    ","\nfunction imageTamplate(image) {\n    return `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${image.largeImageURL}\"\n          ><img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\"\n        /></a>\n        <ul class=\"image-description\">\n          <li class=\"info-item\">\n            <h3 class=\"info-title\">Likes</h3>\n            <p class=\"info-value\">${image.likes}</p>\n          </li>\n          <li class=\"info-item\">\n            <h3 class=\"info-title\">Views</h3>\n            <p class=\"info-value\">${image.views}</p>\n          </li>\n          <li class=\"info-item\">\n            <h3 class=\"info-title\">Comments</h3>\n            <p class=\"info-value\">${image.comments}</p>\n          </li>\n          <li class=\"info-item\">\n            <h3 class=\"info-title\">Downloads</h3>\n            <p class=\"info-value\">${image.downloads}</p>\n          </li>\n        </ul>\n      </li>`\n}\n\nexport function galleryRender(array) {\n    return array.map(imageTamplate).join('');\n    }\n","//імпорт бібліотек та окремих скриптів:\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { getImages } from './js/pixabay-api.js'; //← функція фетчу зображень з серверу\nimport { galleryRender} from './js/render-functions.js'; //← імпорт функції рендеру\n\n//===============================================================================\n// імпорт DOM елементів\n\nconst refs = {\n    form: document.querySelector('.search-form'),\n    gallery: document.querySelector('.gallery'),\n    loader: document.querySelector('.loader'),\n    loadMoreBtn: document.querySelector('.load-more'),\n}\n\nlet currentPage = 1; //← відображаємо номер поточної сторінки (після кожних 15 фото завантажуємо наступні 15, тобто додаємо нову сторінку)\nlet currentQuery = '';\nlet totalHits = 0;\nlet lightbox;\n\n//===============================================================================\n// Налаштовуємо SimpleLightbox\n\nfunction initializeLightbox() {\n      if (lightbox) {\n        lightbox.refresh();\n    } else {\n        lightbox = new SimpleLightbox('.gallery a', {\n            captionDelay: 250,\n            captionsData: 'alt',\n            captionPosition: 'bottom',\n        });\n    }\n}\n//===============================================================================\n//IziToast notifications:\n\nfunction totalHitsQuantity(totalHits) { // функц. кількості знайдених співпадінь за ключем в пошуку;\n    iziToast.success({\n        title: 'Success!',\n        message: `We found ${totalHits} matches! Have fun!`,\n        position: \"topCenter\",\n        messageColor: 'white',\n    });\n}\n\nfunction showNoResultsMessage() { //функц. для помилки пошуку;\n    iziToast.error({\n        title: 'Error!',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        position: \"center\",\n        messageColor: 'white',\n        backgroundColor: '#f0bd40',\n        progressBarColor: '#B51B1B',\n    });\n}\n\nfunction endOfSearchResults() { // функц. для кінця пошуку;\n    iziToast.warning({\n        title: 'Caution!',\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: \"topCenter\",\n        messageColor: 'white',\n        backgroundColor: '#2D4841',\n        progressBarColor: '#658474',\n    });\n}\n//=================================================================================\n//Скрол вниз \n\nfunction getCardHeight() { // Робимо функцію яка визначає висоту фотокартки;\n    const gallery = document.querySelector('.gallery');\n    const firstCard = gallery.firstElementChild;\n    const cardHeight = firstCard.getBoundingClientRect().height;\n    return cardHeight;\n}\n\nfunction smoothScroll() { //функція скролу на висоту двох карток;\n    const cardHeight = getCardHeight();\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n    });\n}\n\n//===============================================================================\n// Налаштовуємо слухач подій та визначаємо, що буде відбуватися при запиті\n\nrefs.form.addEventListener('submit', async event => {\n    event.preventDefault();\n    const query = event.target.elements.query.value.trim();\n    currentPage = 1;\n    currentQuery = query;\n\n    refs.loader.classList.remove('is-hidden'); //← видаляємо клас visually hidden щоб показати, що йде пошук, сторінка чекає на завантаження даних.\n    refs.gallery.innerHTML = '';\n    \n    const data = await getImages(query, currentPage);\n    refs.loader.classList.add('is-hidden');\n    \n    if (data.hits.length === 0) { //якшо пошук не дав результату, тобто знайдено 0 співпадінь з введеним query тоді:\n        refs.loadMoreBtn.classList.add('is-hidden'); // додаємо клас і ховаємо кнопку \"Завантажити ще\"\n        showNoResultsMessage(); // виводимо алерт що за нашим запитом нічого немає\n    } else { //якщо я маю якісь результати:\n        const markup = galleryRender(data.hits); // створюю галерею\n        refs.gallery.innerHTML = markup;\n        \n        initializeLightbox(); // підключаю лайтбокс\n        totalHitsQuantity(data.totalHits); // ← Виводжу кількість знайдених зображень;\n\n        if (data.hits.length < 15) { // якщо кількість зображень менше 15\n            endOfSearchResults(); // Виводимо повідомлення про кінець результатів пошуку\n        }\n\n        if (data.totalHits > 15) {  // якщо результат пошуку видає більше 15 зображень\n            refs.loadMoreBtn.classList.remove('is-hidden'); // знімаю клас приховування і виводжу кнопку \"Завантажити ще\"\n        } else {\n            refs.loadMoreBtn.classList.add('is-hidden'); //якщо меньше 15ти, тоді кнопка ховається\n        }\n    }\n});\n    \n//============================================================================\n// Додаємо наступну сторінку з 15ма зображеннями при кліку по кнопці\n\n//Встановлюємо слухач подій на кнопку \"Завантажити ще\"↓\nrefs.loadMoreBtn.addEventListener('click', loadMoreImages);\n\nasync function loadMoreImages() {\n    currentPage++;  //додаємо до поточної сторінки ще одну\n    refs.loader.classList.remove('is-hidden'); //прибираємо індикатор завантаження інфи\n    refs.gallery.insertAdjacentHTML('beforeend', '<div class=\"loader\"></div>'); // Додаємо loader\n\n    const data = await getImages(currentQuery, currentPage); //завантажуємо діні з серверу\n    const loader = document.querySelector('.gallery .loader');\n    if (loader) {\n        loader.remove(); // Видаляємо loader після завантаження нових зображень\n    }\n\n    if (data.hits.length === 0) { //якщо більше даних не приходить:\n        refs.loadMoreBtn.classList.add('is-hidden'); //ховаємо кнопку\n        endOfSearchResults(); //виводимо алерт що ми досягли кінцевого результату пошуку і більше зображень немає\n    } else {\n        const markup = galleryRender(data.hits); //якщо дані є:\n        refs.gallery.insertAdjacentHTML('beforeend', markup); //створюємо галерею з отриманих даних\n        \n        initializeLightbox(); // запускаємо бібліотеку перегляду зображень\n        smoothScroll() // вмикаємо скрол до нових зображень\n\n        totalHits += data.hits.length;\n\n       if (totalHits >= data.totalHits) {\n            refs.loadMoreBtn.classList.add('is-hidden');\n            endOfSearchResults();\n        } else {\n            refs.loadMoreBtn.classList.remove('is-hidden'); // Показуємо кнопку \"Load more\" якщо є ще зображення\n        }\n    }\n}"],"names":["getImages","query","page","params","axios","error","imageTamplate","image","galleryRender","array","refs","currentPage","currentQuery","totalHits","lightbox","initializeLightbox","SimpleLightbox","totalHitsQuantity","iziToast","showNoResultsMessage","endOfSearchResults","getCardHeight","smoothScroll","cardHeight","event","data","markup","loadMoreImages","loader"],"mappings":"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"}